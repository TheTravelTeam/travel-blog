<div
  class="select"
  role="combobox"
  [attr.aria-expanded]="isOpen()"
  aria-haspopup="listbox"
  [attr.aria-activedescendant]="activeOptionId()"
  (clickOutside)="closeDropDown()"
  (focusout)="onFocusOut($event)"
  (keydown)="navigateWithKey($event)"
>
  <label>{{ label }}</label>

  @if (withMutipleSelect && itemsSelected().length > 0) {
    <div class="select__top-section">
      @for (item of itemsSelected(); track item.id) {
        <span class="chip">
          {{ item.label }}
          <button
            type="button"
            [attr.aria-label]="'Retirer ' + item.label"
            (click)="removeChip(item.id, $event)"
          >
            <app-icon name="close"></app-icon>
          </button>
        </span>
      }
    </div>
  }

  @if (errorMessage()) {
    <div class="error-message">
      <small> ‚Åï{{ errorMessage() }} </small>
    </div>
  }
  <div [class]="['select__container', disabled ? 'disabled' : '']">
    <div class="select__container--input">
      <input
        [value]="inputValue"
        type="text"
        tabindex="-1"
        [placeholder]="placeholder"
        (keydown.enter)="toggleDropdown()"
        (click)="toggleDropdown()"
        readonly
      />
      <button
        type="button"
        class="select__container--button"
        [class.rotate]="isOpen()"
        (click)="toggleDropdown()"
      >
        <app-icon size="lg" color="primary" name="keyboard_arrow_down"></app-icon>
      </button>
    </div>

    <div [@verticalSlide]="isOpen() ? 'open' : 'close'">
      <ul class="select__dropdown" role="listbox" [id]="'dropdown' + id">
        @for (item of itemsList; track item.id; let i = $index) {
          <li
            #dropdownItems
            role="option"
            tabindex="-1"
            [id]="'option-' + i + '-' + id"
            [class.selected]="isSelected(item)"
            (click)="toggleItem(item)"
          >
            {{ item.label }}
          </li>
        }
      </ul>
    </div>
  </div>
</div>
