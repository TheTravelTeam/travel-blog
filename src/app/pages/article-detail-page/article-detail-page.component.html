<section class="article-detail">
  <div class="article-detail__hero">
    <img [src]="heroImage()" alt="Illustration de l'article" class="article-detail__hero-image" />
    <div class="article-detail__hero-overlay"></div>
    @if (article()) {
      <div class="article-detail__hero-content">
        @if (heroDestination()) {
          <span class="article-detail__hero-tag">{{ heroDestination() }}</span>
        }
        <h1 class="article-detail__hero-title">{{ article()!.title }}</h1>
        <p class="article-detail__hero-info">
          @if (formattedUpdatedAt()) {
            <span> Mis à jour le {{ formattedUpdatedAt() }}</span>
          }
        </p>
      </div>
    }
  </div>

  <div class="article-detail__body">
    <app-breadcrumb [breadcrumbItems]="breadcrumbItems()"></app-breadcrumb>

    @if (isLoading()) {
      <p class="article-detail__status">Chargement de l'article…</p>
    } @else {
      @if (error()) {
        <p class="article-detail__status article-detail__status--error">{{ error() }}</p>
      } @else {
        @if (article()) {
          <article class="article-detail__content">
            <div class="article-detail__meta">
              <span class="article-detail__meta-item">
                <app-icon name="account_circle" size="sm"></app-icon>
                {{ getArticleAuthor(article()) }}
              </span>
              @if (formattedUpdatedAt()) {
                <span class="article-detail__meta-item">
                  <app-icon name="calendar_today" size="sm"></app-icon>
                  Mis à jour le {{ formattedUpdatedAt() }}
                </span>
              }
            </div>

            <div
              class="article-detail__rich-text"
              [innerHTML]="article()!.content | safeHtml"
            ></div>

            @if (galleryImages().length) {
              <section class="article-detail__gallery" aria-label="Galerie de l'article">
                <h2>En images</h2>
                <div class="article-detail__gallery-grid">
                  @for (media of galleryImages(); track trackMedia($index, media)) {
                    <figure class="article-detail__gallery-item">
                      <img
                        [src]="media.fileUrl"
                        [alt]="getGalleryImageAlt(media)"
                        loading="lazy"
                        decoding="async"
                        appDefaultImage
                      />
                    </figure>
                  }
                </div>
              </section>
            }
          </article>
        } @else {
          <p class="article-detail__status">Aucun article à afficher.</p>
        }
      }
    }
  </div>
</section>
