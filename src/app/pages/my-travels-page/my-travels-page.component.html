<div class="my-diaries" data-test="my-diaries-page">
  <div
    #detailPanel
    class="my-diaries__detail-panel"
    [ngClass]="isTabletOrMobile() ? state.panelHeight() : ''"
  >
    @if (isTabletOrMobile()) {
      <div class="my-diaries__detail-divider" (click)="togglePanel()">
        <app-divider thickness="thick" radius="15" [isOpenMobile]="true"></app-divider>
      </div>
      <!-- @if (!state.currentDiary()) {
        <div class="search-bar">
          <span class="search-bar__icon material-symbols-outlined">search</span>
          <input type="text" class="search-bar__input" placeholder="Hinted search text" />
        </div>
      } -->
    }
    <!-- @if (state.currentDiary()) { -->
    <div class="my-diaries__detail-panel__header">
      <!-- <div
          class="diary__cover"
          [style]="`background-image: url(${state.getDiaryCoverUrl(state.currentDiary())})`"
        > -->
      <!-- <app-avatar label="" picture="toto" class="diary__avatar"></app-avatar> -->
      <h1 class="my-diaries__detail-panel__header--title">Mes carnets de voyage</h1>

      @if (!isTabletOrMobile()) {
        <div class="my-diaries__detail-divider">
          <app-divider
            thickness="thin"
            radius="15"
            orientation="horizontal"
            color="primary"
          ></app-divider>
        </div>
      }
    </div>

    <div class="my-diaries__detail-panel__body">
      @if (panelError) {
        <p class="my-diaries__error-message">{{ panelError }}</p>
      }
      @if (isCurrentUserDisabled() && !panelError) {
        <p class="my-diaries__error-message">
          Votre compte est désactivé. Vous pouvez consulter vos carnets mais plus les modifier.
        </p>
      }
      @if (isOwner()) {
        <div class="my-diaries__add-button">
          <app-button
            [startIcon]="true"
            color="primary"
            icon="add"
            text="Ajouter"
            size="auto"
            type="standard"
            (btnClick)="openCreateModal()"
            data-test="my-diaries-add"
          ></app-button>
        </div>
      }
      @for (diary of diariesList; track $index) {
        <div class="my-diaries__card" [attr.data-test]="'my-diary-' + diary.id">
          <app-travel-diary-card
            [isAltBackground]="$index % 2 === 1 && !isTabletOrMobile()"
            [ngClass]="{ 'alt-background': $index % 2 === 1 }"
            [id]="diary.id"
            [title]="diary.title"
            [image]="state.getDiaryCoverUrl(diary)"
            [description]="diary.description"
            [showInlineActions]="isOwner()"
            (cardClick)="onDiaryCardClick(diary)"
            (edit)="onDiaryEdit(diary)"
            (delete)="onDiaryDelete(diary)"
          ></app-travel-diary-card>
        </div>
      }
    </div>
  </div>

  @if (isCreateModalOpen) {
  <app-create-diary-modal
    [isMobile]="isTabletOrMobile()"
    [isSubmitting]="isCreateModalSubmitting"
    [errorMessage]="createModalError"
    [availableThemes]="themeOptions"
    [mode]="isEditMode ? 'edit' : 'create'"
    [initialDiary]="editInitialDiary"
    (cancel)="closeCreateModal()"
    (submitDiary)="onDiaryModalSubmit($event)"
  ></app-create-diary-modal>
  }
</div>
